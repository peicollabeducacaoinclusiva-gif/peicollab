# üîó Integra√ß√£o PEI + Plano de AEE no Relat√≥rio

## üéØ Objetivo

O **Plano de AEE** deve aparecer como **anexo** no relat√≥rio PDF do PEI, criando um documento completo e integrado.

---

## üìä Estrutura do Relat√≥rio Integrado

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  PLANO EDUCACIONAL INDIVIDUALIZADO (PEI)                ‚îÇ
‚îÇ  Aluno: Jo√£o Silva                                      ‚îÇ
‚îÇ  Data: 08/01/2025                                       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  SE√á√ÉO 1: IDENTIFICA√á√ÉO DO ALUNO                        ‚îÇ
‚îÇ  SE√á√ÉO 2: OBJETIVOS EDUCACIONAIS                        ‚îÇ
‚îÇ  SE√á√ÉO 3: ESTRAT√âGIAS PEDAG√ìGICAS                       ‚îÇ
‚îÇ  SE√á√ÉO 4: RECURSOS E MATERIAIS                          ‚îÇ
‚îÇ  SE√á√ÉO 5: AVALIA√á√ÉO                                     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  SE√á√ÉO 6: FEEDBACKS DOS PROFISSIONAIS DE APOIO          ‚îÇ
‚îÇ  ‚úì Registros di√°rios de socializa√ß√£o                   ‚îÇ
‚îÇ  ‚úì Registros de autonomia                              ‚îÇ
‚îÇ  ‚úì Registros de comportamento                          ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  SE√á√ÉO 7: REUNI√ïES REALIZADAS                           ‚îÇ
‚îÇ  ‚úì Reuni√£o 1 - 15/03/2025 - Ata completa               ‚îÇ
‚îÇ  ‚úì Reuni√£o 2 - 20/06/2025 - Ata completa               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  SE√á√ÉO 8: AVALIA√á√ïES C√çCLICAS                           ‚îÇ
‚îÇ  ‚úì I Ciclo - Mar√ßo/2025                                ‚îÇ
‚îÇ  ‚úì II Ciclo - Junho/2025                               ‚îÇ
‚îÇ  ‚úì III Ciclo - Novembro/2025                           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó  ‚îÇ
‚îÇ  ‚ïë ANEXO A: PLANO DE ATENDIMENTO EDUCACIONAL        ‚ïë  ‚îÇ
‚îÇ  ‚ïë          ESPECIALIZADO (AEE)                      ‚ïë  ‚îÇ
‚îÇ  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù  ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ  A.1 IDENTIFICA√á√ÉO                                      ‚îÇ
‚îÇ      ‚Ä¢ Aluno: Jo√£o Silva                                ‚îÇ
‚îÇ      ‚Ä¢ Professor AEE: Maria Santos                      ‚îÇ
‚îÇ      ‚Ä¢ Ano Letivo: 2025                                 ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ  A.2 ANAMNESE                                           ‚îÇ
‚îÇ      ‚Ä¢ Hist√≥rico M√©dico                                 ‚îÇ
‚îÇ      ‚Ä¢ Desenvolvimento                                  ‚îÇ
‚îÇ      ‚Ä¢ Contexto Familiar                                ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ  A.3 DIAGN√ìSTICO                                        ‚îÇ
‚îÇ      ‚Ä¢ Tipo de Defici√™ncia: Defici√™ncia Intelectual    ‚îÇ
‚îÇ      ‚Ä¢ Ferramentas Aplicadas: WISC-IV, Vineland        ‚îÇ
‚îÇ      ‚Ä¢ Resultados                                       ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ  A.4 BARREIRAS IDENTIFICADAS                            ‚îÇ
‚îÇ      ‚Ä¢ Barreiras de Aprendizagem                        ‚îÇ
‚îÇ      ‚Ä¢ Barreiras de Acessibilidade                      ‚îÇ
‚îÇ      ‚Ä¢ Barreiras de Comunica√ß√£o                         ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ  A.5 QUEIXAS                                            ‚îÇ
‚îÇ      ‚Ä¢ Queixa da Escola                                 ‚îÇ
‚îÇ      ‚Ä¢ Queixa da Fam√≠lia                                ‚îÇ
‚îÇ      ‚Ä¢ Queixa do Aluno                                  ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ  A.6 RECURSOS E ADAPTA√á√ïES                              ‚îÇ
‚îÇ      ‚Ä¢ Recursos Materiais                               ‚îÇ
‚îÇ      ‚Ä¢ Adapta√ß√µes Curriculares                          ‚îÇ
‚îÇ      ‚Ä¢ Adapta√ß√µes de Avalia√ß√£o                          ‚îÇ
‚îÇ      ‚Ä¢ Adapta√ß√µes Espaciais                             ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ  A.7 OBJETIVOS DE ENSINO                                ‚îÇ
‚îÇ      ‚Ä¢ Objetivo 1: [descri√ß√£o]                          ‚îÇ
‚îÇ      ‚Ä¢ Objetivo 2: [descri√ß√£o]                          ‚îÇ
‚îÇ      ‚Ä¢ Objetivo 3: [descri√ß√£o]                          ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ  A.8 M√âTODOS DE AVALIA√á√ÉO                               ‚îÇ
‚îÇ      ‚Ä¢ Instrumentos Utilizados                          ‚îÇ
‚îÇ      ‚Ä¢ Periodicidade                                    ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ  A.9 ACOMPANHAMENTOS                                    ‚îÇ
‚îÇ      ‚Ä¢ Frequ√™ncia: 2x por semana                        ‚îÇ
‚îÇ      ‚Ä¢ Dura√ß√£o: 50 minutos                              ‚îÇ
‚îÇ      ‚Ä¢ Registro de Sess√µes                              ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ  A.10 ENCAMINHAMENTOS                                   ‚îÇ
‚îÇ       ‚Ä¢ Fonoaudi√≥logo - 10/02/2025                      ‚îÇ
‚îÇ       ‚Ä¢ Psic√≥logo - 15/02/2025                          ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ  A.11 ORIENTA√á√ïES                                       ‚îÇ
‚îÇ       ‚Üí Para a Fam√≠lia                                  ‚îÇ
‚îÇ       ‚Üí Para a Escola                                   ‚îÇ
‚îÇ       ‚Üí Para a Equipe de Apoio                          ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ  A.12 AVALIA√á√ïES C√çCLICAS DO PLANO DE AEE               ‚îÇ
‚îÇ       ‚úì I Ciclo - Progresso e Ajustes                   ‚îÇ
‚îÇ       ‚úì II Ciclo - Evolu√ß√£o                             ‚îÇ
‚îÇ       ‚úì III Ciclo - Resultados Finais                   ‚îÇ
‚îÇ                                                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üíª Implementa√ß√£o no C√≥digo

### **Passo 1: Buscar Plano de AEE Vinculado ao PEI**

No arquivo de gera√ß√£o de PDF do PEI:

```typescript
// src/lib/generatePEIReport.ts

import { supabase } from '@pei/database';

export async function generatePEIReport(peiId: string) {
  // 1. Buscar dados do PEI
  const { data: pei, error: peiError } = await supabase
    .from('peis')
    .select(`
      *,
      student:students(*),
      teachers:pei_teachers(
        user:profiles(full_name)
      )
    `)
    .eq('id', peiId)
    .single();

  if (peiError) throw peiError;

  // 2. Buscar Plano de AEE vinculado
  const { data: planoAEE, error: aeeError } = await supabase
    .from('plano_aee')
    .select(`
      *,
      created_by_user:profiles!created_by(full_name)
    `)
    .eq('pei_id', peiId)
    .single();

  // Se n√£o houver Plano de AEE, ignorar (n√£o √© erro)
  const hasPlanoAEE = !aeeError && planoAEE;

  // 3. Buscar feedbacks do PA
  const { data: feedbacks } = await supabase
    .from('support_professional_feedbacks')
    .select(`
      *,
      support_professional:profiles!support_professional_id(full_name)
    `)
    .eq('student_id', pei.student_id)
    .order('date', { ascending: false });

  // 4. Buscar reuni√µes
  const { data: meetings } = await supabase
    .from('pei_meetings')
    .select(`
      *,
      pei_meeting_peis!inner(pei_id)
    `)
    .eq('pei_meeting_peis.pei_id', peiId);

  // 5. Buscar avalia√ß√µes c√≠clicas
  const { data: evaluations } = await supabase
    .from('pei_evaluations')
    .select('*')
    .eq('pei_id', peiId)
    .order('cycle');

  // 6. Gerar PDF
  return generatePDF({
    pei,
    planoAEE: hasPlanoAEE ? planoAEE : null,
    feedbacks: feedbacks || [],
    meetings: meetings || [],
    evaluations: evaluations || [],
  });
}
```

---

### **Passo 2: Estruturar o PDF com o Plano de AEE**

```typescript
// src/lib/pdfGenerator.ts

import jsPDF from 'jspdf';

export function generatePDF(data: {
  pei: any;
  planoAEE: any | null;
  feedbacks: any[];
  meetings: any[];
  evaluations: any[];
}) {
  const doc = new jsPDF();
  let yPosition = 20;

  // ===== CABE√áALHO =====
  doc.setFontSize(18);
  doc.setFont('helvetica', 'bold');
  doc.text('PLANO EDUCACIONAL INDIVIDUALIZADO (PEI)', 105, yPosition, {
    align: 'center',
  });
  yPosition += 10;

  doc.setFontSize(12);
  doc.setFont('helvetica', 'normal');
  doc.text(`Aluno: ${data.pei.student.full_name}`, 20, yPosition);
  yPosition += 7;
  doc.text(`Data: ${new Date().toLocaleDateString('pt-BR')}`, 20, yPosition);
  yPosition += 15;

  // ===== SE√á√ïES DO PEI =====
  yPosition = addPEISections(doc, data.pei, yPosition);

  // ===== FEEDBACKS DO PA =====
  if (data.feedbacks.length > 0) {
    yPosition = addPAFeedbacks(doc, data.feedbacks, yPosition);
  }

  // ===== REUNI√ïES =====
  if (data.meetings.length > 0) {
    yPosition = addMeetings(doc, data.meetings, yPosition);
  }

  // ===== AVALIA√á√ïES C√çCLICAS =====
  if (data.evaluations.length > 0) {
    yPosition = addEvaluations(doc, data.evaluations, yPosition);
  }

  // ===== PLANO DE AEE (ANEXO) =====
  if (data.planoAEE) {
    doc.addPage(); // Nova p√°gina para o anexo
    yPosition = 20;
    
    doc.setFontSize(16);
    doc.setFont('helvetica', 'bold');
    doc.setTextColor(0, 100, 200); // Azul
    doc.text('ANEXO A: PLANO DE ATENDIMENTO EDUCACIONAL ESPECIALIZADO (AEE)', 105, yPosition, {
      align: 'center',
    });
    yPosition += 15;

    doc.setTextColor(0, 0, 0); // Preto
    doc.setFontSize(12);
    doc.setFont('helvetica', 'normal');

    // A.1 IDENTIFICA√á√ÉO
    doc.setFont('helvetica', 'bold');
    doc.text('A.1 IDENTIFICA√á√ÉO', 20, yPosition);
    yPosition += 7;
    doc.setFont('helvetica', 'normal');
    doc.text(`Aluno: ${data.pei.student.full_name}`, 25, yPosition);
    yPosition += 5;
    doc.text(`Professor AEE: ${data.planoAEE.created_by_user?.full_name || 'N/A'}`, 25, yPosition);
    yPosition += 5;
    doc.text(`Ano Letivo: 2025`, 25, yPosition);
    yPosition += 10;

    // A.2 ANAMNESE
    if (data.planoAEE.anamnesis_data) {
      doc.setFont('helvetica', 'bold');
      doc.text('A.2 ANAMNESE', 20, yPosition);
      yPosition += 7;
      doc.setFont('helvetica', 'normal');
      
      const anamneseText = JSON.stringify(data.planoAEE.anamnesis_data, null, 2);
      const anamneseLines = doc.splitTextToSize(anamneseText, 170);
      doc.text(anamneseLines, 25, yPosition);
      yPosition += anamneseLines.length * 5 + 5;
    }

    // A.3 DIAGN√ìSTICO
    if (data.planoAEE.diagnosis_tools && Array.isArray(data.planoAEE.diagnosis_tools)) {
      doc.setFont('helvetica', 'bold');
      doc.text('A.3 DIAGN√ìSTICO', 20, yPosition);
      yPosition += 7;
      doc.setFont('helvetica', 'normal');
      
      data.planoAEE.diagnosis_tools.forEach((tool: any, index: number) => {
        doc.text(`‚Ä¢ ${tool.tool_name || `Ferramenta ${index + 1}`}`, 25, yPosition);
        yPosition += 5;
        if (tool.results) {
          const resultLines = doc.splitTextToSize(`  Resultados: ${tool.results}`, 165);
          doc.text(resultLines, 25, yPosition);
          yPosition += resultLines.length * 5;
        }
        yPosition += 3;
      });
      yPosition += 5;
    }

    // A.4 BARREIRAS
    if (data.planoAEE.learning_barriers) {
      doc.setFont('helvetica', 'bold');
      doc.text('A.4 BARREIRAS IDENTIFICADAS', 20, yPosition);
      yPosition += 7;
      doc.setFont('helvetica', 'normal');
      
      const barriersData = Array.isArray(data.planoAEE.learning_barriers)
        ? data.planoAEE.learning_barriers
        : [data.planoAEE.learning_barriers];
      
      barriersData.forEach((barrier: any) => {
        const barrierText = typeof barrier === 'string' ? barrier : JSON.stringify(barrier);
        const barrierLines = doc.splitTextToSize(`‚Ä¢ ${barrierText}`, 170);
        doc.text(barrierLines, 25, yPosition);
        yPosition += barrierLines.length * 5 + 3;
      });
      yPosition += 5;
    }

    // A.5 QUEIXAS
    if (data.planoAEE.school_complaint || data.planoAEE.family_complaint) {
      doc.setFont('helvetica', 'bold');
      doc.text('A.5 QUEIXAS', 20, yPosition);
      yPosition += 7;
      doc.setFont('helvetica', 'normal');
      
      if (data.planoAEE.school_complaint) {
        doc.text('Queixa da Escola:', 25, yPosition);
        yPosition += 5;
        const schoolLines = doc.splitTextToSize(data.planoAEE.school_complaint, 165);
        doc.text(schoolLines, 25, yPosition);
        yPosition += schoolLines.length * 5 + 5;
      }
      
      if (data.planoAEE.family_complaint) {
        doc.text('Queixa da Fam√≠lia:', 25, yPosition);
        yPosition += 5;
        const familyLines = doc.splitTextToSize(data.planoAEE.family_complaint, 165);
        doc.text(familyLines, 25, yPosition);
        yPosition += familyLines.length * 5 + 5;
      }
      yPosition += 5;
    }

    // A.6 RECURSOS E ADAPTA√á√ïES
    if (data.planoAEE.resources || data.planoAEE.adaptations) {
      doc.setFont('helvetica', 'bold');
      doc.text('A.6 RECURSOS E ADAPTA√á√ïES', 20, yPosition);
      yPosition += 7;
      doc.setFont('helvetica', 'normal');
      
      if (data.planoAEE.resources) {
        doc.text('Recursos:', 25, yPosition);
        yPosition += 5;
        const resourcesText = JSON.stringify(data.planoAEE.resources, null, 2);
        const resourcesLines = doc.splitTextToSize(resourcesText, 165);
        doc.text(resourcesLines, 25, yPosition);
        yPosition += resourcesLines.length * 5 + 5;
      }
      
      if (data.planoAEE.adaptations) {
        doc.text('Adapta√ß√µes:', 25, yPosition);
        yPosition += 5;
        const adaptText = JSON.stringify(data.planoAEE.adaptations, null, 2);
        const adaptLines = doc.splitTextToSize(adaptText, 165);
        doc.text(adaptLines, 25, yPosition);
        yPosition += adaptLines.length * 5 + 5;
      }
      yPosition += 5;
    }

    // A.7 OBJETIVOS DE ENSINO
    if (data.planoAEE.teaching_objectives) {
      doc.setFont('helvetica', 'bold');
      doc.text('A.7 OBJETIVOS DE ENSINO', 20, yPosition);
      yPosition += 7;
      doc.setFont('helvetica', 'normal');
      
      const objectivesData = Array.isArray(data.planoAEE.teaching_objectives)
        ? data.planoAEE.teaching_objectives
        : [data.planoAEE.teaching_objectives];
      
      objectivesData.forEach((obj: any, index: number) => {
        const objText = typeof obj === 'string' ? obj : JSON.stringify(obj);
        doc.text(`${index + 1}. ${objText}`, 25, yPosition);
        yPosition += 5;
      });
      yPosition += 5;
    }

    // A.8 M√âTODOS DE AVALIA√á√ÉO
    if (data.planoAEE.evaluation_methodology) {
      doc.setFont('helvetica', 'bold');
      doc.text('A.8 M√âTODOS DE AVALIA√á√ÉO', 20, yPosition);
      yPosition += 7;
      doc.setFont('helvetica', 'normal');
      
      const evalLines = doc.splitTextToSize(data.planoAEE.evaluation_methodology, 170);
      doc.text(evalLines, 25, yPosition);
      yPosition += evalLines.length * 5 + 10;
    }

    // A.9 ACOMPANHAMENTOS
    if (data.planoAEE.follow_ups) {
      doc.setFont('helvetica', 'bold');
      doc.text('A.9 ACOMPANHAMENTOS', 20, yPosition);
      yPosition += 7;
      doc.setFont('helvetica', 'normal');
      
      const followUpsText = JSON.stringify(data.planoAEE.follow_ups, null, 2);
      const followUpsLines = doc.splitTextToSize(followUpsText, 170);
      doc.text(followUpsLines, 25, yPosition);
      yPosition += followUpsLines.length * 5 + 10;
    }

    // A.10 ENCAMINHAMENTOS
    if (data.planoAEE.referrals) {
      doc.setFont('helvetica', 'bold');
      doc.text('A.10 ENCAMINHAMENTOS', 20, yPosition);
      yPosition += 7;
      doc.setFont('helvetica', 'normal');
      
      const referralsText = JSON.stringify(data.planoAEE.referrals, null, 2);
      const referralsLines = doc.splitTextToSize(referralsText, 170);
      doc.text(referralsLines, 25, yPosition);
      yPosition += referralsLines.length * 5 + 10;
    }

    // A.11 ORIENTA√á√ïES
    if (data.planoAEE.family_guidance || data.planoAEE.school_guidance || data.planoAEE.other_guidance) {
      doc.setFont('helvetica', 'bold');
      doc.text('A.11 ORIENTA√á√ïES', 20, yPosition);
      yPosition += 7;
      doc.setFont('helvetica', 'normal');
      
      if (data.planoAEE.family_guidance) {
        doc.text('Para a Fam√≠lia:', 25, yPosition);
        yPosition += 5;
        const familyGuidLines = doc.splitTextToSize(data.planoAEE.family_guidance, 165);
        doc.text(familyGuidLines, 25, yPosition);
        yPosition += familyGuidLines.length * 5 + 5;
      }
      
      if (data.planoAEE.school_guidance) {
        doc.text('Para a Escola:', 25, yPosition);
        yPosition += 5;
        const schoolGuidLines = doc.splitTextToSize(data.planoAEE.school_guidance, 165);
        doc.text(schoolGuidLines, 25, yPosition);
        yPosition += schoolGuidLines.length * 5 + 5;
      }
      
      if (data.planoAEE.other_guidance) {
        doc.text('Outras Orienta√ß√µes:', 25, yPosition);
        yPosition += 5;
        const otherGuidLines = doc.splitTextToSize(data.planoAEE.other_guidance, 165);
        doc.text(otherGuidLines, 25, yPosition);
        yPosition += otherGuidLines.length * 5 + 5;
      }
      yPosition += 5;
    }

    // A.12 AVALIA√á√ïES C√çCLICAS DO AEE
    if (data.planoAEE.cycle_1_evaluation || data.planoAEE.cycle_2_evaluation || data.planoAEE.cycle_3_evaluation) {
      doc.setFont('helvetica', 'bold');
      doc.text('A.12 AVALIA√á√ïES C√çCLICAS DO PLANO DE AEE', 20, yPosition);
      yPosition += 7;
      doc.setFont('helvetica', 'normal');
      
      if (data.planoAEE.cycle_1_evaluation) {
        doc.text('I Ciclo:', 25, yPosition);
        yPosition += 5;
        const cycle1Text = JSON.stringify(data.planoAEE.cycle_1_evaluation, null, 2);
        const cycle1Lines = doc.splitTextToSize(cycle1Text, 165);
        doc.text(cycle1Lines, 25, yPosition);
        yPosition += cycle1Lines.length * 5 + 5;
      }
      
      if (data.planoAEE.cycle_2_evaluation) {
        doc.text('II Ciclo:', 25, yPosition);
        yPosition += 5;
        const cycle2Text = JSON.stringify(data.planoAEE.cycle_2_evaluation, null, 2);
        const cycle2Lines = doc.splitTextToSize(cycle2Text, 165);
        doc.text(cycle2Lines, 25, yPosition);
        yPosition += cycle2Lines.length * 5 + 5;
      }
      
      if (data.planoAEE.cycle_3_evaluation) {
        doc.text('III Ciclo:', 25, yPosition);
        yPosition += 5;
        const cycle3Text = JSON.stringify(data.planoAEE.cycle_3_evaluation, null, 2);
        const cycle3Lines = doc.splitTextToSize(cycle3Text, 165);
        doc.text(cycle3Lines, 25, yPosition);
        yPosition += cycle3Lines.length * 5 + 5;
      }
    }
  }

  // Retornar o PDF
  return doc;
}

// Fun√ß√µes auxiliares (addPEISections, addPAFeedbacks, etc.)
// ...
```

---

## üé® Customiza√ß√£o Visual do Anexo

Para destacar o anexo no PDF:

```typescript
// Adicionar borda ao anexo
doc.setDrawColor(0, 100, 200); // Azul
doc.setLineWidth(0.5);
doc.rect(15, 15, 180, 10); // Borda no t√≠tulo

// Adicionar marca d'√°gua
doc.setTextColor(200, 200, 200); // Cinza claro
doc.setFontSize(40);
doc.text('ANEXO', 105, 150, {
  align: 'center',
  angle: 45,
});
doc.setTextColor(0, 0, 0); // Voltar ao preto
```

---

## ‚úÖ Checklist de Implementa√ß√£o

- [x] Migra√ß√£o SQL do Plano de AEE aplicada
- [x] App Plano de AEE criado e rodando
- [ ] Fun√ß√£o de busca do Plano de AEE por `pei_id` implementada
- [ ] Se√ß√£o de anexo adicionada ao gerador de PDF
- [ ] Teste de gera√ß√£o de PDF com Plano de AEE
- [ ] Teste de PDF sem Plano de AEE (deve funcionar normalmente)

---

## üß™ Como Testar

1. Crie um PEI para um aluno
2. Crie um Plano de AEE vinculado ao PEI (usando o `pei_id`)
3. No PEI Collab, v√° at√© o PEI
4. Clique em "Gerar Relat√≥rio PDF"
5. **Verifique**: O PDF deve ter o anexo com o Plano de AEE completo

---

## üéâ Resultado Final

O relat√≥rio PDF ter√°:

‚úÖ **Se√ß√µes do PEI** (todas as informa√ß√µes originais)  
‚úÖ **Feedbacks do PA** (se houver)  
‚úÖ **Reuni√µes** (se houver)  
‚úÖ **Avalia√ß√µes C√≠clicas do PEI**  
‚úÖ **ANEXO A: Plano de AEE** (completo e formatado)

Criando assim um **documento √∫nico e integrado** para cada aluno! üöÄ

