{
  "meta": {
    "project": "PEI Collab",
    "date": "2025-10-29",
    "prepared_by": "Software Development Manager"
  },
  "product_overview": "PEI Collab is a collaborative platform designed for managing Individualized Educational Plans (PEIs), focusing on educational inclusion and integration among education networks, schools, teachers, families, and specialists. It supports mobile-first, offline-first, and PWA capabilities to facilitate seamless access and collaboration.",
  "core_goals": [
    "Enable comprehensive creation, editing, and versioning of Individualized Educational Plans with automated version control and approval workflows.",
    "Provide secure multi-tenant hierarchical access for networks, schools, and users with robust role-based permissions.",
    "Facilitate collaborative involvement of all stakeholders including teachers, specialists, coordinators, families, and school administrators.",
    "Support offline-first capabilities with local caching and automatic synchronization to ensure uninterrupted access and data integrity.",
    "Deliver a mobile-first responsive design and Progressive Web App features for optimized user experience on diverse devices.",
    "Ensure auditability and traceability of all PEI changes, access logs, and user activities for compliance and monitoring."
  ],
  "key_features": [
    "Multi-role Authentication System supporting roles such as superadmin, coordinator, teacher, family, education secretary, school director, specialist, and aee_teacher with hierarchical permissions.",
    "Role-based Dashboards providing tailored interfaces and functionalities according to user role.",
    "Complete PEI Management including diagnosis, planning, referrals, goals, specialist orientations, meetings, and evaluations with multi-version support and status tracking.",
    "Student Management with registration, editing, and secure access controls, including family access via expiring token system.",
    "Multi-tenant hierarchical system managing networks, schools, and users to ensure data segregation and access control.",
    "Offline-First Architecture using IndexedDB (Dexie.js) with local caching and automatic synchronization on reconnect to maintain data consistency.",
    "Progressive Web App features with service worker, cache management, push notifications, and install prompt for enhanced mobile usability.",
    "Mobile-First Responsive Design optimized for various screen sizes with navigation optimized for mobile devices.",
    "Audit and Logging system capturing all significant actions and changes with detailed version and access history.",
    "CSV Import/Export functionality for bulk data management supporting students and users.",
    "Gamified Student Interface providing achievement systems and interactive activities for students.",
    "Tutorial and Onboarding System to assist new users in platform navigation and feature use."
  ],
  "user_flow_summary": [
    "User Authentication: Users log in through secure multi-role authentication; permissions decide dashboard and access scope.",
    "PEI Lifecycle: Authorized users create, edit, submit, and approve PEIs with automatic version management and audit logging.",
    "Family Access: Families access PEIs of their children securely through temporary tokens that expire after a set period.",
    "Offline Use: Users access cached data offline; changes are synchronized automatically upon reconnect.",
    "Notifications & Meetings: Users receive notifications about PEI updates and participate in scheduled meetings relevant to PEIs.",
    "Data Management: Superadmins and authorized roles manage users, students, schools, and tenants using specialized dashboards and CSV import/export tools.",
    "Mobile & PWA Experience: Users install the app as a PWA, navigate via mobile-optimized UI, and benefit from offline and push notifications."
  ],
  "validation_criteria": [
    "Successful login and correct role-based dashboard rendering for all defined user roles.",
    "Creation, editing, versioning, and approval of PEIs follow the defined workflow with only one active version per student.",
    "Offline data caching and syncing work seamlessly without data loss or conflicts on reconnect.",
    "Family access tokens correctly generate, expire after the set timeframe, and restrict access as intended.",
    "Multiple role access and permissions are enforced at the database row level (RLS) ensuring no unauthorized data leakage.",
    "PWA features including install prompt, offline fallback, and push notifications function correctly across supported devices.",
    "All changes and accesses to PEIs and related data are audited and recorded with user context and timestamp.",
    "Responsive UI adapts properly to various screen sizes and devices, facilitating mobile-first usage.",
    "CSV import and export features handle large datasets with error handling and data validation.",
    "Automated tests cover critical flows including authentication, PEI versioning, offline sync, and permission enforcement."
  ],
  "code_summary": {
    "tech_stack": [
      "TypeScript",
      "React",
      "Vite",
      "Tailwind CSS",
      "Supabase",
      "PostgreSQL",
      "PWA",
      "IndexedDB",
      "React Router",
      "React Hook Form",
      "Zod",
      "Radix UI",
      "Lucide React",
      "TanStack Query",
      "Dexie.js"
    ],
    "features": [
      {
        "name": "Authentication System",
        "description": "Sistema de autenticação com múltiplos roles (superadmin, coordinator, teacher, family, school_manager, aee_teacher, specialist, education_secretary, school_director)",
        "files": [
          "src/pages/Auth.tsx",
          "src/pages/Dashboard.tsx",
          "src/hooks/usePermissions.ts",
          "src/hooks/useTenant.ts",
          "src/lib/supabaseClient.ts",
          "src/integrations/supabase/client.ts"
        ]
      },
      {
        "name": "Role-based Dashboards",
        "description": "Dashboards específicos para cada tipo de usuário com funcionalidades personalizadas",
        "files": [
          "src/components/dashboards/SuperadminDashboard.tsx",
          "src/components/dashboards/CoordinatorDashboard.tsx",
          "src/components/dashboards/TeacherDashboard.tsx",
          "src/components/dashboards/FamilyDashboard.tsx",
          "src/components/dashboards/SchoolManagerDashboard.tsx",
          "src/components/dashboards/AEETeacherDashboard.tsx",
          "src/components/dashboards/SpecialistDashboard.tsx",
          "src/components/dashboards/EducationSecretaryDashboard.tsx",
          "src/components/dashboards/SchoolDirectorDashboard.tsx"
        ]
      },
      {
        "name": "PEI Management",
        "description": "Sistema completo de criação, edição e acompanhamento de Planos Educacionais Individualizados",
        "files": [
          "src/pages/CreatePEI.tsx",
          "src/components/pei/DiagnosisSection.tsx",
          "src/components/pei/PlanningSection.tsx",
          "src/components/pei/StudentIdentificationSection.tsx",
          "src/components/pei/ReferralsSection.tsx",
          "src/components/pei/PEITemplateSelector.tsx",
          "src/components/pei/PEIVersionCompare.tsx",
          "src/components/pei/PEIVersionHistory.tsx",
          "src/components/pei/ProgressIndicator.tsx",
          "src/components/pei/ReportView.tsx",
          "src/hooks/usePEIVersioning.ts"
        ]
      },
      {
        "name": "Student Management",
        "description": "Gestão completa de alunos com cadastro, edição e visualização de dados",
        "files": [
          "src/components/superadmin/CreateStudentDialog.tsx",
          "src/components/superadmin/EditStudentDialog.tsx",
          "src/components/superadmin/StudentsTable.tsx",
          "src/components/superadmin/StudentsTableWithCache.tsx",
          "src/components/forms/OfflineStudentForm.tsx"
        ]
      },
      {
        "name": "Multi-tenant Architecture",
        "description": "Arquitetura multi-tenant hierárquica (rede → escolas → usuários)",
        "files": [
          "src/components/superadmin/CreateTenantDialog.tsx",
          "src/components/superadmin/EditTenantDialog.tsx",
          "src/components/superadmin/TenantsTable.tsx",
          "src/hooks/useTenant.ts"
        ]
      },
      {
        "name": "User Management",
        "description": "Sistema de gestão de usuários com criação, edição e atribuição de roles",
        "files": [
          "src/components/superadmin/CreateUserDialog.tsx",
          "src/components/superadmin/EditUserDialog.tsx",
          "src/components/superadmin/UsersTable.tsx",
          "src/components/superadmin/SuperadminUserManagement.tsx"
        ]
      },
      {
        "name": "Family Access System",
        "description": "Sistema de acesso seguro para famílias visualizarem PEIs dos filhos",
        "files": [
          "src/pages/FamilyAccess.tsx",
          "src/pages/FamilyPEIView.tsx",
          "src/pages/SecureFamilyAccess.tsx",
          "src/components/family/FamilyPEIAccess.tsx",
          "src/components/coordinator/GenerateFamilyTokenDialog.tsx",
          "src/components/coordinator/FamilyTokenManager.tsx"
        ]
      },
      {
        "name": "Offline-First Architecture",
        "description": "Funcionalidade offline com sincronização automática quando online",
        "files": [
          "src/lib/offlineStorage.ts",
          "src/lib/offlineDatabase.ts",
          "src/hooks/useOfflineQuery.ts",
          "src/hooks/useOfflineSync.ts",
          "src/hooks/useOnlineStatus.ts",
          "src/hooks/useSyncOnReconnect.ts",
          "src/components/shared/OfflineIndicator.tsx",
          "src/components/shared/PendingChangesIndicator.tsx",
          "src/services/SyncService.ts",
          "src/services/cacheService.ts",
          "src/services/pendingChangesService.ts"
        ]
      },
      {
        "name": "PWA Features",
        "description": "Progressive Web App com service worker, cache e notificações push",
        "files": [
          "src/components/shared/PWAUpdatePrompt.tsx",
          "src/lib/notifications.ts",
          "src/components/shared/NotificationManager.tsx",
          "src/components/shared/NotificationBell.tsx",
          "vite.config.ts"
        ]
      },
      {
        "name": "Gamified Student Interface",
        "description": "Interface gamificada para estudantes com sistema de conquistas e atividades",
        "files": [
          "src/components/student/StudentGamifiedDashboard.tsx",
          "src/components/student/AchievementSystem.tsx",
          "src/components/student/GamifiedActivity.tsx"
        ]
      },
      {
        "name": "Mobile-First Design",
        "description": "Design responsivo e mobile-first com navegação otimizada para dispositivos móveis",
        "files": [
          "src/components/shared/MobileNavigation.tsx",
          "src/components/shared/ResponsiveLayout.tsx",
          "src/components/forms/MobilePEIForm.tsx",
          "src/hooks/use-mobile.tsx"
        ]
      },
      {
        "name": "Performance Optimization",
        "description": "Otimizações de performance para dispositivos móveis e conexões lentas",
        "files": [
          "src/lib/performanceOptimizer.ts",
          "src/lib/databaseTests.ts"
        ]
      },
      {
        "name": "Audit and Logging",
        "description": "Sistema de auditoria e logs para rastreamento de mudanças",
        "files": [
          "src/components/shared/AuditLogsViewer.tsx",
          "src/components/shared/SimpleAuditLogsViewer.tsx"
        ]
      },
      {
        "name": "CSV Import/Export",
        "description": "Funcionalidade de importação e exportação de dados via CSV",
        "files": [
          "src/components/superadmin/CSVUploadDialog.tsx",
          "src/components/superadmin/ImportCSVDialog.tsx"
        ]
      },
      {
        "name": "Testing and Debug Tools",
        "description": "Ferramentas de teste e debug para desenvolvimento e monitoramento",
        "files": [
          "src/components/debug/DatabaseTestRunner.tsx",
          "src/components/debug/UsabilityTestingManager.tsx",
          "src/components/debug/ImportTest.tsx",
          "src/components/dashboards/DebugUser.tsx",
          "src/lib/usabilityTesting.ts"
        ]
      },
      {
        "name": "Theme and UI Components",
        "description": "Sistema de temas e componentes UI reutilizáveis baseados em Radix UI",
        "files": [
          "src/components/shared/ThemeToggle.tsx",
          "src/components/ui/",
          "src/components/shared/InstitutionalLogo.tsx"
        ]
      },
      {
        "name": "PEI Meetings and Orientations",
        "description": "Sistema de reuniões e orientações relacionadas aos PEIs",
        "files": [
          "src/pages/PEIMeetings.tsx",
          "src/pages/PEIOrientations.tsx"
        ]
      },
      {
        "name": "Tutorial System",
        "description": "Sistema de tutoriais e onboarding para novos usuários",
        "files": [
          "src/components/tutorial/TutorialCards.tsx"
        ]
      }
    ]
  }
}
